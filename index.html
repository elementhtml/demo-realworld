<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>ElementHTML â€¢ RealWorld</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="//code.ionicframework.com" crossorigin>
    <link rel="preconnect" href="//demo.productionready.io" crossorigin>

    <!-- <link rel="modulepreload" href="../element/element.js?load&expose&packages=rw"> -->
    <link rel="modulepreload"
        href="https://cdn.jsdelivr.net/gh/elementhtml/element@5dbad33b2dddff1547013e85919a0920795990a9/element.min.js?load&expose&packages=rw">

    <link rel="preload" as="style"
        href="//fonts.googleapis.com/css?family=Titillium+Web:700|Source+Serif+Pro:400,700|Merriweather+Sans:400,700|Source+Sans+Pro:400,300,600,700,300italic,400italic,600italic,700italic&display=swap">
    <link rel="preload" as="style" href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link rel="preload" as="style" href="//demo.productionready.io/main.css">
    <link rel="preload" as="style" href="theme/dark.css">

    <link href="//code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" rel="stylesheet" type="text/css" />
    <link
        href="//fonts.googleapis.com/css?family=Titillium+Web:700|Source+Serif+Pro:400,700|Merriweather+Sans:400,700|Source+Sans+Pro:400,300,600,700,300italic,400italic,600italic,700italic&display=swap"
        rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="//demo.productionready.io/main.css" />
    <link rel="stylesheet" href="theme/dark.css" />

    <script type="importmap">
        {
            "imports": {
                "rw": "./packages/rw.js"
            }
        }
    </script>
    <!-- <script type="module" src='../element/element.js?load&expose&packages=rw'></script> -->
    <script type="module"
        src='https://cdn.jsdelivr.net/gh/elementhtml/element@5dbad33b2dddff1547013e85919a0920795990a9/element.js?load&expose&packages=rw'></script>

    <script is="e-flowscript" type="script/flow" id="index">
        `sessionStorage.getItem(user)` >> ($ ? $eval($) : null) >> #user >> ($ ? $string($) : null) >> `sessionStorage.setItem(user, ${})`
        # ?? "home" >> %section: /\/([a-z0-9\-]+)\/?/ ?? "home" >> templates/${}.html ?? ~404 >> $(:|main) 
        #[feedConfig, feedEndpoint, headers] >> qs: ($queryString($[0])) 
            >> (`transforms/feed-config.jsonata`) >> ~${~api}/${#feedEndpoint}?${$qs}~ 
            >> ({"feed": $.articles, "pagination": { "count": $.articlesCount, "offset": $cells.feedConfig.offset, "limit": $cells.feedConfig.limit}})
            >> %{feed!, pagination!}
        #user ?? {} >> (`transforms/mainnav.jsonata`) >> $(#mainnav) 
            >> ($merge([{"Content-Type": "application/json"}, $cells.user.token ? {"Authorization": "Token " & $cells.user.token} : {}])) >> #headers            
        #errors >> ({"<li>": ($cells.errors ? [$each($cells.errors, function($v, $k) { $k & ": " & $join($v, ", ") })] : [])}) >> $(:|.error-messages)
        %[section, #user] >> (`transforms/mainnav.jsonata`) >> $(#mainnav)
        %feed >> (`transforms/article-list.jsonata`) >> $(:|.article-list)
        %pagination >> (`transforms/pagination.jsonata`) >> $(:|.pagination)
        $(:|.pagination li a) >> ($merge([$context.feedDefaultConfig, $cells.feedConfig, {"offset": $number($.`@data-offset`), "limit": $number($.`@data-limit`)}])) 
            >> #feedConfig
        $(:|.tag-list a) >> tag: ($.textContent) >> (`transforms/set-tag.jsonata`) >> $(:|.page) 
            >> (["articles", $merge([$context.feedDefaultConfig, {"offset": 0, "tag": $labels.tag}])]) >> #[feedEndpoint, feedConfig]
        $(:|.article-preview .btn-outline-primary,.article-preview .btn-outline-primary *) >> slug: ($._closest.id) 
            >> article: ($single($fields.feed, function($v) {$v.slug = $labels.slug}))
            >> ({"headers": $cells.headers, "method": $labels.article.favorited ? "DELETE" : "POST"}) >> ~${~api}/articles/${slug}/favorite~ 
            >> ([$map($fields.feed, function($v){ $v.slug = $labels.slug ? $.article : $v})]) >> %feed!
    </script>
    <template id="feed-article-preview">
        <div class="article-preview">
            <div class="article-meta">
                <a href><img src /></a>
                <div class="info">
                    <a href class="author"></a>
                    <span class="date"></span>
                </div>
                <button class="btn btn-outline-primary btn-sm pull-xs-right">
                    <i class="ion-heart"></i> <span class="favorites-count"></span>
                </button>
            </div>
            <a href class="preview-link">
                <h1></h1>
                <p></p>
                <span>Read more...</span>
                <ul class="tag-list"></ul>
            </a>
        </div>
    </template>

</head>

<body>
    <header>
        <nav class="navbar navbar-light">
            <div class="container">
                <a class="navbar-brand" href="./">conduit</a>
                <ul class="nav navbar-nav pull-xs-right" id="mainnav">
                    <li class="nav-item">
                        <a class="nav-link active" href="#/">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#/login"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#/register"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#/editor"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#/settings"></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#/profile/"></a>
                    </li>
                </ul>
            </div>
        </nav>
    </header>

    <main></main>

    <footer>
        <div class="container">
            <a href="./" class="logo-font">conduit</a>
            <span class="attribution">
                An interactive learning project from <a href="https://thinkster.io">Thinkster</a>. Code &amp;
                design licensed under MIT.
            </span>
        </div>
    </footer>
</body>

</html>